#!/usr/bin/env bash

export BIN_INSTALL_DIR="`pwd`/git2/bin"
export LIB_INSTALL_DIR="`pwd`/git2/lib"
export INCLUDE_INSTALL_DIR="`pwd`/git2/include"
export BUILD_CLAR=off
mkdir -p "$BIN_INSTALL_DIR"
mkdir -p "$LIB_INSTALL_DIR"
mkdir -p "$INCLUDE_INSTALL_DIR"
mkdir libgit2
cd libgit2
git init
git remote add origin https://github.com/libgit2/libgit2.git
git pull origin v0.24.3
mkdir build
cd build
cmake ..
cmake --build . --target install
cd ../..
export CRYSTAL_GIT_LDFLAGS="-L`pwd`/git2/lib"
crystal spec -D travis
